{% extends "base.html" %} {% block content %}
<div>
  <div>
    <img
      src="{{ url_for('static', filename='') }}{{ current_user.user_profile_picture }}"
    />
    <p>{{ current_user.user_identifiant }}</p>
  </div>

  <div>
    <nav>
      <ul>
        <li>
          <a
            id="overview"
            href="/overview"
            onclick="navigateInOverviewTabs(event)"
            >Overview</a
          >
        </li>
        <li>
          <a
            id="contracts"
            href="/overview?tab=contracts"
            onclick="navigateInOverviewTabs(event)"
            >Contrats {{ current_user.contracts|length }}</a
          >
        </li>
      </ul>
    </nav>

    <div id="overview_div">Je suis dans overview</div>
    <div id="contracts_div">
      <a href="{{ url_for('controllers.contract.add_contract') }}"
        >Ajouter un contrat</a
      >
      {% for contract in current_user.contracts %}
      <p>{{ contract.contract_category }}</p>
      <p>{{ contract.contract_name }}</p>
      <p>{{ contract.contract_mens }}</p>
      <a
        href="{{ url_for('controllers.contract.show_contract', id=contract.id) }}"
        >Voir le contrat</a
      >
      {% endfor %}
    </div>
  </div>

  <script type="text/javascript">
    let tab = "{{ tab }}";
    console.log(tab);
    window.onload = toggleNav(tab);

    function toggleNav(tab) {
      document.getElementById("overview_div").style.display = "none";
      document.getElementById("contracts_div").style.display = "none";
      document.getElementById(tab + "_div").style.display = "block";
    }

    function navigateInOverviewTabs(event) {
      event.preventDefault();
      let tab = event.target;
      test_url = tab.getAttribute("href");
      window.history.pushState(null, "", test_url);
      toggleNav(tab.id);
    }
  </script>
</div>
{% endblock %}
